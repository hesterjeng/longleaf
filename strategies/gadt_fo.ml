open Gadt
module I = Tacaml.Indicator.Raw

let ( @@@ ) f x = App (f, x)
let uid () = Var (Uuidm.v4_gen Util.random_state ())

(* Single argument indicators *)
let dema = Fun I.dema @@@ uid ()
let ema = Fun I.ema @@@ uid ()
let kama = Fun I.kama @@@ uid ()
let ma = Fun I.ma @@@ uid ()
let midpoint = Fun I.midpoint @@@ uid ()
let midprice = Fun I.midprice @@@ uid ()
let sma = Fun I.sma @@@ uid ()
let tema = Fun I.tema @@@ uid ()
let trima = Fun I.trima @@@ uid ()
let wma = Fun I.wma @@@ uid ()
let adx = Fun I.adx @@@ uid ()
let adxr = Fun I.adxr @@@ uid ()
let aroon_osc = Fun I.aroon_osc @@@ uid ()
let cci = Fun I.cci @@@ uid ()
let cmo = Fun I.cmo @@@ uid ()
let dx = Fun I.dx @@@ uid ()
let mfi = Fun I.mfi @@@ uid ()
let minus_di = Fun I.minus_di @@@ uid ()
let minus_dm = Fun I.minus_dm @@@ uid ()
let mom = Fun I.mom @@@ uid ()
let plus_di = Fun I.plus_di @@@ uid ()
let plus_dm = Fun I.plus_dm @@@ uid ()
let roc = Fun I.roc @@@ uid ()
let rocp = Fun I.rocp @@@ uid ()
let rocr = Fun I.rocr @@@ uid ()
let rocr100 = Fun I.rocr100 @@@ uid ()
let rsi = Fun I.rsi @@@ uid ()
let trix = Fun I.trix @@@ uid ()
let willr = Fun I.willr @@@ uid ()
let atr = Fun I.atr @@@ uid ()
let natr = Fun I.natr @@@ uid ()
let aroon_down = Fun I.aroon_down @@@ uid ()
let aroon_up = Fun I.aroon_up @@@ uid ()
let beta = Fun I.beta @@@ uid ()
let correl = Fun I.correl @@@ uid ()
let linearreg = Fun I.linearreg @@@ uid ()
let linearreg_angle = Fun I.linearreg_angle @@@ uid ()
let linearreg_intercept = Fun I.linearreg_intercept @@@ uid ()
let linearreg_slope = Fun I.linearreg_slope @@@ uid ()
let min_max_min = Fun I.min_max_min @@@ uid ()
let min_max_max = Fun I.min_max_max @@@ uid ()
let tsf = Fun I.tsf @@@ uid ()
let max = Fun I.max @@@ uid ()
let min = Fun I.min @@@ uid ()
let sum = Fun I.sum @@@ uid ()
let avgdev = Fun I.avgdev @@@ uid ()
let imi = Fun I.imi @@@ uid ()
let accbands_upper = Fun I.accbands_upper @@@ uid ()
let accbands_middle = Fun I.accbands_middle @@@ uid ()
let accbands_lower = Fun I.accbands_lower @@@ uid ()

(* Two argument indicators *)
let mama = Fun I.mama @@@ uid () @@@ uid ()
let mavp = Fun I.mavp @@@ uid () @@@ uid ()
let sar = Fun I.sar @@@ uid () @@@ uid ()
let t3 = Fun I.t3 @@@ uid () @@@ uid ()
let apo = Fun I.apo @@@ uid () @@@ uid ()
let ppo = Fun I.ppo @@@ uid () @@@ uid ()
let adosc = Fun I.adosc @@@ uid () @@@ uid ()
let stddev = Fun I.stddev @@@ uid () @@@ uid ()
let var = Fun I.var @@@ uid () @@@ uid ()
let mama_mama = Fun I.mama_mama @@@ uid () @@@ uid ()
let mama_fama = Fun I.mama_fama @@@ uid () @@@ uid ()
let stoch_f_fast_k = Fun I.stoch_f_fast_k @@@ uid () @@@ uid ()
let stoch_f_fast_d = Fun I.stoch_f_fast_d @@@ uid () @@@ uid ()

(* Three argument indicators *)
let upper_bband = Fun I.upper_bband @@@ uid () @@@ uid () @@@ uid ()
let middle_bband = Fun I.middle_bband @@@ uid () @@@ uid () @@@ uid ()
let lower_bband = Fun I.lower_bband @@@ uid () @@@ uid () @@@ uid ()
let macd_macd = Fun I.macd_macd @@@ uid () @@@ uid () @@@ uid ()
let macd_signal = Fun I.macd_signal @@@ uid () @@@ uid () @@@ uid ()
let macd_hist = Fun I.macd_hist @@@ uid () @@@ uid () @@@ uid ()
let macd_ext_macd = Fun I.macd_ext_macd @@@ uid () @@@ uid () @@@ uid ()
let macd_ext_signal = Fun I.macd_ext_signal @@@ uid () @@@ uid () @@@ uid ()
let macd_ext_hist = Fun I.macd_ext_hist @@@ uid () @@@ uid () @@@ uid ()
let ultosc = Fun I.ultosc @@@ uid () @@@ uid () @@@ uid ()
let stoch_slow_k = Fun I.stoch_slow_k @@@ uid () @@@ uid () @@@ uid ()
let stoch_slow_d = Fun I.stoch_slow_d @@@ uid () @@@ uid () @@@ uid ()
let stoch_rsi_fast_k = Fun I.stoch_rsi_fast_k @@@ uid () @@@ uid () @@@ uid ()
let stoch_rsi_fast_d = Fun I.stoch_rsi_fast_d @@@ uid () @@@ uid () @@@ uid ()

(* Zero argument indicators *)
let ht_trendline = Fun (fun () -> I.ht_trendline)
let ad = Fun (fun () -> I.ad)
let obv = Fun (fun () -> I.obv)
let trange = Fun (fun () -> I.trange)
let avg_price = Fun (fun () -> I.avg_price)
let med_price = Fun (fun () -> I.med_price)
let typ_price = Fun (fun () -> I.typ_price)
let wcl_price = Fun (fun () -> I.wcl_price)
let ht_dc_period = Fun (fun () -> I.ht_dc_period)
let ht_dc_phase = Fun (fun () -> I.ht_dc_phase)
let ht_phasor_inphase = Fun (fun () -> I.ht_phasor_inphase)
let ht_phasor_quadrature = Fun (fun () -> I.ht_phasor_quadrature)
let ht_sine_sine = Fun (fun () -> I.ht_sine_sine)
let ht_sine_leadsine = Fun (fun () -> I.ht_sine_leadsine)
let acos = Fun (fun () -> I.acos)
let asin = Fun (fun () -> I.asin)
let atan = Fun (fun () -> I.atan)
let ceil = Fun (fun () -> I.ceil)
let cos = Fun (fun () -> I.cos)
let cosh = Fun (fun () -> I.cosh)
let exp = Fun (fun () -> I.exp)
let floor = Fun (fun () -> I.floor)
let ln = Fun (fun () -> I.ln)
let log10 = Fun (fun () -> I.log10)
let sin = Fun (fun () -> I.sin)
let sinh = Fun (fun () -> I.sinh)
let sqrt = Fun (fun () -> I.sqrt)
let tan = Fun (fun () -> I.tan)
let tanh = Fun (fun () -> I.tanh)
let add = Fun (fun () -> I.add)
let div = Fun (fun () -> I.div)
let mult = Fun (fun () -> I.mult)
let sub = Fun (fun () -> I.sub)
let bop = Fun (fun () -> I.bop)

(* Candlestick patterns (most are zero args, some have one arg) *)
let ht_trend_mode = Fun (fun () -> I.ht_trend_mode)
let cdl_2crows = Fun (fun () -> I.cdl_2crows)
let cdl_3blackcrows = Fun (fun () -> I.cdl_3blackcrows)
let cdl_3inside = Fun (fun () -> I.cdl_3inside)
let cdl_3linestrike = Fun (fun () -> I.cdl_3linestrike)
let cdl_3outside = Fun (fun () -> I.cdl_3outside)
let cdl_3starsinsouth = Fun (fun () -> I.cdl_3starsinsouth)
let cdl_3whitesoldiers = Fun (fun () -> I.cdl_3whitesoldiers)
let cdl_abandonedbaby = Fun I.cdl_abandonedbaby @@@ uid ()
let cdl_advanceblock = Fun (fun () -> I.cdl_advanceblock)
let cdl_belthold = Fun (fun () -> I.cdl_belthold)
let cdl_breakaway = Fun (fun () -> I.cdl_breakaway)
let cdl_closingmarubozu = Fun (fun () -> I.cdl_closingmarubozu)
let cdl_concealbabyswall = Fun (fun () -> I.cdl_concealbabyswall)
let cdl_counterattack = Fun (fun () -> I.cdl_counterattack)
let cdl_darkcloudcover = Fun I.cdl_darkcloudcover @@@ uid ()
let cdl_doji = Fun (fun () -> I.cdl_doji)
let cdl_dojistar = Fun (fun () -> I.cdl_dojistar)
let cdl_dragonflydoji = Fun (fun () -> I.cdl_dragonflydoji)
let cdl_engulfing = Fun (fun () -> I.cdl_engulfing)
let cdl_eveningdojistar = Fun I.cdl_eveningdojistar @@@ uid ()
let cdl_eveningstar = Fun I.cdl_eveningstar @@@ uid ()
let cdl_gap_side_side_white = Fun (fun () -> I.cdl_gap_side_side_white)
let cdl_gravestonedoji = Fun (fun () -> I.cdl_gravestonedoji)
let cdl_hammer = Fun (fun () -> I.cdl_hammer)
let cdl_hangingman = Fun (fun () -> I.cdl_hangingman)
let cdl_harami = Fun (fun () -> I.cdl_harami)
let cdl_haramicross = Fun (fun () -> I.cdl_haramicross)
let cdl_highwave = Fun (fun () -> I.cdl_highwave)
let cdl_hikkake = Fun (fun () -> I.cdl_hikkake)
let cdl_hikkakemod = Fun (fun () -> I.cdl_hikkakemod)
let cdl_homingpigeon = Fun (fun () -> I.cdl_homingpigeon)
let cdl_identical3crows = Fun (fun () -> I.cdl_identical3crows)
let cdl_inneck = Fun (fun () -> I.cdl_inneck)
let cdl_invertedhammer = Fun (fun () -> I.cdl_invertedhammer)
let cdl_kicking = Fun (fun () -> I.cdl_kicking)
let cdl_kickingbylength = Fun (fun () -> I.cdl_kickingbylength)
let cdl_ladderbottom = Fun (fun () -> I.cdl_ladderbottom)
let cdl_longleggedDoji = Fun (fun () -> I.cdl_longleggedDoji)
let cdl_longline = Fun (fun () -> I.cdl_longline)
let cdl_marubozu = Fun (fun () -> I.cdl_marubozu)
let cdl_matchinglow = Fun (fun () -> I.cdl_matchinglow)
let cdl_mathold = Fun I.cdl_mathold @@@ uid ()
let cdl_morningdojistar = Fun I.cdl_morningdojistar @@@ uid ()
let cdl_morningstar = Fun I.cdl_morningstar @@@ uid ()
let cdl_onneck = Fun (fun () -> I.cdl_onneck)
let cdl_piercing = Fun (fun () -> I.cdl_piercing)
let cdl_rickshawman = Fun (fun () -> I.cdl_rickshawman)
let cdl_risefall3methods = Fun (fun () -> I.cdl_risefall3methods)
let cdl_separatinglines = Fun (fun () -> I.cdl_separatinglines)
let cdl_shootingstar = Fun (fun () -> I.cdl_shootingstar)
let cdl_shortline = Fun (fun () -> I.cdl_shortline)
let cdl_spinningtop = Fun (fun () -> I.cdl_spinningtop)
let cdl_stalledpattern = Fun (fun () -> I.cdl_stalledpattern)
let cdl_sticksandwich = Fun (fun () -> I.cdl_sticksandwich)
let cdl_takuri = Fun (fun () -> I.cdl_takuri)
let cdl_tasukigap = Fun (fun () -> I.cdl_tasukigap)
let cdl_thrusting = Fun (fun () -> I.cdl_thrusting)
let cdl_tristar = Fun (fun () -> I.cdl_tristar)
let cdl_unique3river = Fun (fun () -> I.cdl_unique3river)
let cdl_upsidegap2crows = Fun (fun () -> I.cdl_upsidegap2crows)
let cdl_xsidegap3methods = Fun (fun () -> I.cdl_xsidegap3methods)
let max_index = Fun I.max_index @@@ uid ()
let min_index = Fun I.min_index @@@ uid ()
let min_max_index_min = Fun I.min_max_index_min @@@ uid ()
let min_max_index_max = Fun I.min_max_index_max @@@ uid ()

module Examples = struct

  let expr =
    GT (atr, 0,0)

end
